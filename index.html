<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sippy - Your Living Hydration Companion. Stay hydrated, stay focused!">
    <meta name="theme-color" content="#0077BE">
    <title>Sippy - Your Living Hydration Companion</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/icons/favicon.ico">
    <link rel="manifest" href="manifest.json">
    
    <!-- Stylesheets -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
</head>
<body>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('service-worker.js').catch(() => {});
            });
        }
    </script>
    <!-- Welcome Modal (First Time Users) -->
    <div id="welcomeModal" class="modal">
        <div class="modal-content welcome-card">
            <div class="mascot-large" id="welcomeMascot">💧</div>
            <h1>Welcome to Sippy!</h1>
            <p>Your living hydration companion 🫧</p>
            <p class="subtitle">Stay hydrated, stay focused, stay energized!</p>
            <div class="welcome-input">
                <label for="userName">What should we call you? (optional)</label>
                <input type="text" id="userName" placeholder="Your name" maxlength="20">
            </div>
            <div class="welcome-input">
                <label for="userWeight">Your weight (kg) for personalized goals:</label>
                <input type="number" id="userWeight" placeholder="60" min="30" max="200" value="70">
            </div>
            <button class="btn-primary btn-large" id="startBtn">Let's Start! 💧</button>
            <p class="privacy-note">🔒 No login required. All data stays on your device.</p>
        </div>
    </div>

    <!-- Top Navigation -->
    <nav class="top-nav hidden" id="topNav">
        <div class="nav-left">
            <span class="logo-icon">💦</span>
            <span class="logo-text">Sippy</span>
        </div>
        <div class="nav-links">
            <a href="#dashboard" class="nav-link">Dashboard</a>
            <a href="#achievements" class="nav-link">Achievements</a>
            <a href="#report" class="nav-link">Report</a>
            <a href="#privacy" class="nav-link">Privacy</a>
            <a href="#settings" class="nav-link">Settings</a>
        </div>
    </nav>

    <!-- Page: Dashboard -->
    <div id="page-dashboard" class="dashboard hidden">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="logo">
                <span class="logo-icon">💧</span>
                <span class="logo-text">Sippy</span>
            </div>
            <div class="header-right">
                <div class="weather-widget" id="weatherWidget">
                    <span class="weather-icon">☀️</span>
                    <span class="weather-temp">--°C</span>
                    <span class="weather-location">Chennai</span>
                </div>
                <div class="points-display" id="headerPoints">
                    <span class="points-icon">⭐</span>
                    <span class="points-value">0</span>
                </div>
                <button class="icon-btn" id="settingsBtn" title="Settings">⚙️</button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Hero Section - Progress Ring -->
            <section class="hero-section">
                <div class="progress-container">
                    <svg class="progress-ring" width="280" height="280">
                        <circle class="progress-ring-bg" cx="140" cy="140" r="120" />
                        <circle class="progress-ring-fill" cx="140" cy="140" r="120" id="progressCircle" />
                    </svg>
                    <div class="progress-center">
                        <div class="progress-mascot" id="centerMascot">💦</div>
                        <div class="progress-text">
                            <span class="progress-value" id="progressPercent">0%</span>
                            <span class="progress-label">Daily Goal</span>
                        </div>
                        <div class="progress-stats">
                            <span id="currentIntake">0</span> / <span id="dailyGoal">2000</span> ml
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="quick-actions">
                    <button class="quick-btn" data-amount="50">50ml</button>
                    <button class="quick-btn" data-amount="100">100ml</button>
                    <button class="quick-btn" data-amount="250">250ml</button>
                    <button class="quick-btn" data-amount="500">500ml</button>
                    <button class="quick-btn custom" id="customAmountBtn">Custom</button>
                </div>
            </section>

            <!-- Stats Cards -->
            <section class="stats-section">
                <div class="stat-card">
                    <div class="stat-icon">🔥</div>
                    <div class="stat-content">
                        <div class="stat-value" id="streakValue">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📊</div>
                    <div class="stat-content">
                        <div class="stat-value" id="weeklyAvg">0</div>
                        <div class="stat-label">Weekly Avg (ml)</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🏆</div>
                    <div class="stat-content">
                        <div class="stat-value" id="achievementCount">0</div>
                        <div class="stat-label">Achievements</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⭐</div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalPoints">0</div>
                        <div class="stat-label">Total Points</div>
                    </div>
                </div>
            </section>

            <!-- Today's Log -->
            <section class="log-section">
                <h2>Today's Hydration Log</h2>
                <div class="log-container" id="todayLog">
                    <p class="empty-state">No drinks logged yet. Start drinking water! 💧</p>
                </div>
            </section>

            <!-- Charts -->
            <section class="charts-section">
                <div class="chart-card">
                    <h3>7-Day Hydration Trend</h3>
                    <canvas id="weeklyChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>Today's Hourly Intake</h3>
                    <canvas id="hourlyChart"></canvas>
                </div>
            </section>

            <!-- Actions -->
            <section class="actions-section">
                <button class="btn-secondary" id="viewReportBtn">📄 View My Progress Report</button>
                <button class="btn-secondary" id="achievementsBtn">🏆 View Achievements</button>
            </section>
        </main>
    </div>

    <!-- Floating Bubble Widget (THE STAR) -->
    <div id="bubbleWidget" class="bubble-widget hidden" draggable="true">
        <div class="bubble-inner">
            <div class="bubble-face" id="bubbleFace">💦</div>
            <div class="bubble-points" id="bubblePoints">0</div>
            <div class="bubble-ring"></div>
        </div>
        <div class="bubble-menu hidden" id="bubbleMenu">
            <button class="bubble-menu-btn" data-action="log">💧 Log Water</button>
            <button class="bubble-menu-btn" data-action="stats">📊 Stats</button>
            <button class="bubble-menu-btn" data-action="snooze">😴 Snooze</button>
        </div>
        <div class="bubble-message hidden" id="bubbleMessage"></div>
    </div>

    <!-- Settings Panel -->
    <div id="settingsPanel" class="side-panel hidden">
        <div class="panel-header">
            <h2>Settings</h2>
            <button class="close-btn" id="closeSettings">✕</button>
        </div>
        <div class="panel-content">
            <div class="settings-section">
                <h3>Profile</h3>
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="settingsName" placeholder="Your name">
                </div>
                <div class="form-group">
                    <label>Weight (kg)</label>
                    <input type="number" id="settingsWeight" min="30" max="200">
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Hydration</h3>
                <div class="form-group">
                    <label>Daily Goal (ml)</label>
                    <input type="number" id="settingsGoal" min="1000" max="5000" step="100" readonly>
                    <small>Auto-calculated based on weight and Chennai weather</small>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Reminders</h3>
                <div class="form-group">
                    <label>Reminder Frequency (minutes)</label>
                    <input type="range" id="reminderFrequency" min="20" max="120" step="5" value="45">
                    <span id="frequencyValue">45</span> minutes
                </div>
                <div class="form-group">
                    <label>Sound Volume</label>
                    <input type="range" id="soundVolume" min="0" max="100" step="10" value="50">
                    <span id="volumeValue">50</span>%
                </div>
                <div class="form-group checkbox">
                    <input type="checkbox" id="enableNotifications" checked>
                    <label for="enableNotifications">Enable Browser Notifications</label>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Appearance</h3>
                <div class="form-group">
                    <label>Theme</label>
                    <select id="themeSelect">
                        <option value="ocean">Ocean Breeze (Default)</option>
                        <option value="forest">Forest Green</option>
                        <option value="sunset">Sunset Orange</option>
                        <option value="midnight">Midnight Purple</option>
                        <option value="chennai">Chennai Marina</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Bubble Size</label>
                    <select id="bubbleSize">
                        <option value="small">Small</option>
                        <option value="medium" selected>Medium</option>
                        <option value="large">Large</option>
                    </select>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Privacy</h3>
                <div class="form-group checkbox">
                    <input type="checkbox" id="enableActivityTracking" checked>
                    <label for="enableActivityTracking">Enable Activity Tracking</label>
                </div>
                <div class="form-group checkbox">
                    <input type="checkbox" id="enableMemory" checked>
                    <label for="enableMemory">Enable Hydra-Memory mini-game</label>
                </div>
                <div class="form-group">
                    <button class="btn-secondary" id="exportDataBtn">📥 Export Data</button>
                    <button class="btn-danger" id="wipeDataBtn">🗑️ Wipe All Data</button>
                    <button class="btn-secondary" id="privacyInfoBtn">🔒 Privacy Info</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Page: Achievements -->
    <div id="page-achievements" class="page hidden">
        <div class="page-container">
            <h2>🏆 Achievements</h2>
            <div class="achievements-grid" id="achievementsGridPage"></div>
        </div>
    </div>

    <!-- Page: Report -->
    <div id="page-report" class="page hidden">
        <div class="page-container">
            <h2>📄 My Hydration Report</h2>
            <p>Download your daily/weekly progress as a PDF.</p>
            <button class="btn-primary" id="downloadReportBtn">Download Report</button>
        </div>
    </div>

    <!-- Page: Privacy -->
    <div id="page-privacy" class="page hidden">
        <div class="page-container">
            <h2>🔒 Privacy Dashboard</h2>
            <p>All processing happens locally. No login, no cloud, no telemetry.</p>
            <div class="privacy-actions">
                <button class="btn-secondary" id="exportDataBtnPage">📥 Export Data</button>
                <button class="btn-danger" id="wipeDataBtnPage">🗑️ Wipe All Data</button>
            </div>
        </div>
    </div>

    <!-- Page: Settings -->
    <div id="page-settings" class="page hidden">
        <div class="page-container">
            <h2>⚙️ Settings</h2>
            <p>Use the Settings panel from the dashboard or manage quick options here.</p>
            <div class="form-group">
                <label>Theme</label>
                <select id="themeSelectPage">
                    <option value="ocean">Ocean Breeze (Default)</option>
                    <option value="forest">Forest Green</option>
                    <option value="sunset">Sunset Orange</option>
                    <option value="midnight">Midnight Purple</option>
                    <option value="chennai">Chennai Marina</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="notification-toast hidden"></div>

    <!-- Scripts -->
    <script src="js/constants.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/dataManager.js"></script>
    <script src="js/weatherService.js"></script>
    <script src="js/hydrationEngine.js"></script>
    <script src="js/activityTracker.js"></script>
    <script src="js/reminderSystem.js"></script>
    <script src="js/focusEconomy.js"></script>
    <script src="js/memoryTest.js"></script>
    <script src="js/pdfGenerator.js"></script>
    <script src="components/bubbleWidget.js"></script>
    <script src="components/mascot.js"></script>
    <script src="components/chatInterface.js"></script>
    <script src="components/dashboard.js"></script>
    <script src="components/charts.js"></script>
    <script src="components/settings.js"></script>
    <script src="components/privacyDashboard.js"></script>
    <script src="components/notifications.js"></script>
    <script src="js/app.js"></script>
</body>
</html>

